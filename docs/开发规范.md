# LinkFox AI设计平台 - 开发规范

## 代码规范

### Java代码规范

#### 1. 命名规范
```java
// 类名：大驼峰命名
public class UserController {}

// 方法名：小驼峰命名
public void getUserInfo() {}

// 常量：全大写，下划线分隔
public static final String DEFAULT_AVATAR = "/default.png";

// 变量：小驼峰命名
private String userName;

// 包名：全小写
package com.linkfox.service;
```

#### 2. 注释规范
```java
/**
 * 用户服务接口
 * 
 * @author LinkFox
 * @date 2024-01-01
 */
public interface UserService {
    
    /**
     * 根据ID获取用户信息
     * 
     * @param id 用户ID
     * @return 用户信息
     */
    User getUserById(Long id);
}
```

#### 3. Controller规范
```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    /**
     * 获取用户信息
     */
    @GetMapping("/{id}")
    public Result<User> getUserById(@PathVariable Long id) {
        try {
            User user = userService.getUserById(id);
            return Result.success(user);
        } catch (Exception e) {
            log.error("获取用户信息失败", e);
            return Result.error(e.getMessage());
        }
    }
}
```

#### 4. Service规范
```java
@Service
@Transactional
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserMapper userMapper;
    
    @Override
    public User getUserById(Long id) {
        if (id == null) {
            throw new IllegalArgumentException("用户ID不能为空");
        }
        return userMapper.selectById(id);
    }
}
```

#### 5. 异常处理
```java
// 自定义业务异常
public class BusinessException extends RuntimeException {
    private Integer code;
    
    public BusinessException(String message) {
        super(message);
        this.code = 500;
    }
    
    public BusinessException(Integer code, String message) {
        super(message);
        this.code = code;
    }
}

// 全局异常处理器
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(BusinessException.class)
    public Result<?> handleBusinessException(BusinessException e) {
        return Result.error(e.getCode(), e.getMessage());
    }
    
    @ExceptionHandler(Exception.class)
    public Result<?> handleException(Exception e) {
        log.error("系统异常", e);
        return Result.error("系统异常，请稍后重试");
    }
}
```

### Vue代码规范

#### 1. 组件命名
```javascript
// 单文件组件：大驼峰命名
UserProfile.vue
ArtworkCard.vue
UploadArea.vue

// 组件注册：大驼峰或短横线
import UserProfile from '@/components/UserProfile.vue'
// 或
import { defineComponent } from 'vue'
```

#### 2. 组件结构
```vue
<template>
  <!-- 模板内容 -->
  <div class="user-profile">
    <!-- ... -->
  </div>
</template>

<script setup>
// 导入
import { ref, computed, onMounted } from 'vue'
import { useUserStore } from '@/stores/user'

// Props定义
const props = defineProps({
  userId: {
    type: Number,
    required: true
  }
})

// Emits定义
const emit = defineEmits(['update', 'delete'])

// 响应式数据
const user = ref(null)
const loading = ref(false)

// 计算属性
const fullName = computed(() => {
  return `${user.value?.firstName} ${user.value?.lastName}`
})

// 方法
const loadUser = async () => {
  loading.value = true
  try {
    // 加载逻辑
  } finally {
    loading.value = false
  }
}

// 生命周期
onMounted(() => {
  loadUser()
})
</script>

<style scoped lang="scss">
.user-profile {
  // 样式
}
</style>
```

#### 3. 命名规范
```javascript
// 变量和方法：小驼峰
const userName = ref('')
const handleClick = () => {}

// 组件：大驼峰
const UserCard = defineComponent({})

// 常量：全大写
const MAX_FILE_SIZE = 10 * 1024 * 1024

// CSS类名：短横线
.user-profile {}
.btn-primary {}
```

#### 4. Props验证
```javascript
const props = defineProps({
  // 基础类型检查
  userId: Number,
  
  // 多类型
  value: [String, Number],
  
  // 必填字段
  title: {
    type: String,
    required: true
  },
  
  // 带默认值
  status: {
    type: String,
    default: 'active'
  },
  
  // 对象默认值
  user: {
    type: Object,
    default: () => ({})
  },
  
  // 自定义验证
  age: {
    type: Number,
    validator: (value) => value >= 0 && value <= 150
  }
})
```

#### 5. 事件命名
```javascript
// 使用短横线命名
emit('update-user', user)
emit('delete-item', id)

// 在模板中使用
<UserCard @update-user="handleUpdate" @delete-item="handleDelete" />
```

### SCSS规范

#### 1. 嵌套规范
```scss
// 最多3层嵌套
.user-card {
  padding: 16px;
  
  .user-header {
    display: flex;
    
    .user-avatar {
      width: 48px;
      height: 48px;
    }
  }
  
  // 伪类
  &:hover {
    box-shadow: var(--shadow-md);
  }
  
  // 修饰符
  &.active {
    border-color: var(--primary-color);
  }
}
```

#### 2. 变量使用
```scss
// 使用CSS变量
.btn {
  color: var(--primary-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-md);
}

// SCSS变量
$breakpoint-mobile: 768px;

@media (max-width: $breakpoint-mobile) {
  // 移动端样式
}
```

## Git提交规范

### Commit Message格式
```
<type>(<scope>): <subject>

<body>

<footer>
```

### Type类型
- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 代码格式调整（不影响功能）
- `refactor`: 重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具相关

### 示例
```bash
# 新功能
git commit -m "feat(user): 添加用户注册功能"

# 修复bug
git commit -m "fix(artwork): 修复图片上传失败的问题"

# 文档更新
git commit -m "docs(readme): 更新部署文档"

# 样式调整
git commit -m "style(navbar): 调整导航栏样式"
```

## 数据库规范

### 1. 表命名
- 小写字母
- 下划线分隔
- 单数形式
```sql
CREATE TABLE user (...);
CREATE TABLE artwork (...);
CREATE TABLE user_artwork (...);
```

### 2. 字段命名
```sql
-- 主键
id BIGINT PRIMARY KEY AUTO_INCREMENT

-- 布尔类型用is_开头
is_active TINYINT DEFAULT 1

-- 时间字段用_time或_at结尾
create_time DATETIME
updated_at TIMESTAMP

-- 逻辑删除
deleted TINYINT DEFAULT 0
```

### 3. 索引规范
```sql
-- 单列索引
INDEX idx_user_id (user_id)

-- 联合索引
INDEX idx_user_status (user_id, status)

-- 唯一索引
UNIQUE KEY uk_username (username)

-- 全文索引
FULLTEXT INDEX ft_content (content)
```

## API设计规范

### 1. RESTful规范
```
GET    /api/users          # 获取用户列表
GET    /api/users/{id}     # 获取单个用户
POST   /api/users          # 创建用户
PUT    /api/users/{id}     # 更新用户
DELETE /api/users/{id}     # 删除用户
```

### 2. 响应格式
```json
// 成功响应
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}

// 失败响应
{
  "code": 400,
  "message": "参数错误",
  "data": null
}

// 分页响应
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "pageNum": 1,
    "pageSize": 20,
    "records": []
  }
}
```

### 3. 状态码规范
- `200`: 成功
- `201`: 创建成功
- `400`: 请求参数错误
- `401`: 未授权
- `403`: 禁止访问
- `404`: 资源不存在
- `500`: 服务器错误

## 测试规范

### 1. 单元测试
```java
@SpringBootTest
public class UserServiceTest {
    
    @Autowired
    private UserService userService;
    
    @Test
    public void testGetUserById() {
        User user = userService.getUserById(1L);
        assertNotNull(user);
        assertEquals("testuser", user.getUsername());
    }
}
```

### 2. 前端测试
```javascript
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import UserCard from '@/components/UserCard.vue'

describe('UserCard', () => {
  it('renders properly', () => {
    const wrapper = mount(UserCard, {
      props: { userId: 1 }
    })
    expect(wrapper.text()).toContain('User')
  })
})
```

## 代码审查清单

### 功能
- [ ] 功能是否正常工作
- [ ] 是否有边界情况处理
- [ ] 是否有错误处理

### 性能
- [ ] 是否有性能问题
- [ ] 数据库查询是否优化
- [ ] 是否有内存泄漏

### 安全
- [ ] 是否有SQL注入风险
- [ ] 是否有XSS风险
- [ ] 敏感信息是否加密

### 代码质量
- [ ] 代码是否易读
- [ ] 是否有重复代码
- [ ] 命名是否规范
- [ ] 注释是否清晰

### 测试
- [ ] 是否有单元测试
- [ ] 测试覆盖率是否达标

---

遵守以上开发规范，可以保证代码质量和团队协作效率。

